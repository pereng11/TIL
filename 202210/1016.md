# 22/10/16

## 오늘 고민한 것

### 큰 그림 보기 vs 하나하나 차근차근 하기

- 어떤 기능을 만들 때, 처음부터 너무 많은 걸 생각하는 버릇을 고치려고 노력하는 중이다. 확장성이나 예외상황 등을 고민하다 핵심에서 벗어나 옆길로 새는 일이 많았기 때문이다.
- 그런데 단순하게 생각해서 한 번에 하나만 하다보니 설계 방향이 잘못되어 중간에 갈아엎어야 하는 상황이 또 발생하기도 한다. 
- 결국 모든 건 *적당히* 하라는 것 같은데...정말 감 잡기가 너무 어렵다

### 구조를 해치지 않으면서 예외사항 처리하기

#### 라이브러리 이벤트 핸들러 함수

- 컴포넌트에서 이벤트 핸들러를 받아올 때 이벤트 타입, CSS 선택자, 핸들러 함수 3가지 정보를 받아온다. 기존에는 selector를 이용하여 라이브러리 내부에서 early return을 해주었는데, 이벤트 타깃이 window인 경우 matches나 closest함수를 사용할 수 없어 오류가 발생했다. 
- window는 예외상황이라고 보고, 조건문에 `selector === 'window'`인 경우를 추가했는데, 이게 깔끔한 처리인지, 땜빵 코드인지 모르겠다..

### 지난 번 만들었던 CBD 라이브러리의 컴포넌트가 지역상태를 가질 수 있도록 하기

#### 시작하기 전

- 내가 생각하는 전역 상태 / 지역 상태는 다음과 같다
	- 전역 상태: 컴포넌트 외부에서 생성되고, props으로 내려줄 필요 없이 필요한 곳에서 바로 import해서 사용할 수 있는 상태
	- 지역 상태: 컴포넌트 내부에서 직접 생성하며, 필요한 하위 컴포넌트에 props로 건네주는 상태
- 위 관점에서 보면 기존에 만들었던 라이브러리는 전역 상태를 사용할 수 없고, 루트 컴포넌트만이 지역 상태를 가질 수 있었다.  상태가 컴포넌트 내부에서 생성되며, 루트 컴포넌트를 제외한 나머지 컴포넌트는 재렌더링이 될 때 상태를 유지할 수 없었기 때문이다.
- 어플리케이션의 규모가 커지면서 루트컴포넌트 한 곳에서 모든 상태를 관리하는 것이 불가능해졌기 때문에 모든 컴포넌트에서 지역상태를 사용할 수 있도록 할 필요가 생겼다
- 지금 생각나는 건 크게 두 가지인데, 아직 구체적인 방법은 더 고민해봐야 할 것 같다
	1. reconciliation을 부분적으로 적용하기
	2. reconciliation 구조를 유지하고 이전 상태를 기억할 수 있도록 하기

#### 리액트의 구조를 이해하고 본따서 만들어보자

- 고민 끝에 2번 방법으로 만들기로 결정했다. 기존 라이브러리의 구조가 리액트의 구조를 참고한 것이었는데, 

- 참고문헌
	- https://www.netlify.com/blog/2019/03/11/deep-dive-how-do-react-hooks-really-work/